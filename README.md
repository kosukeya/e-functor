# プロジェクト概要
本リポジトリは圏論的な視点をニューラルネットに応用し、統計圏（モデル）と意味圏（データ生成世界）を「ε-関手」で動的に結びつける研究的実験コードです。

# コード構造の全体像
experiment.py が単一の実験スクリプトで、データ生成からモデル定義、学習ループ、可視化まで一貫して記述されています。以下の主なパートがあります。

データ生成: 簡易的な「植物の成長」シナリオをシミュレートし、plant(0/1), sun, water, growth を作成して学習/検証に分割。

モデル定義:

MultiHeadSelfAttention は標準的なマルチヘッド注意層。

MultiIWorldModel は入力 [plant, sun, water] から3つの潜在トークン I1–I3 を生成し、growth クエリトークンを含む 7 トークンに対して自己注意を適用。意味ブランチ（head_sem）と統計ブランチ（head_stat）の2ヘッドを持ち、return_both フラグで両方の出力とアテンションを返します。

FStatWrapper はメインモデルの EMA 教師版で、スケール制御付き出力を提供し、弱い因果/単調性制約用に利用。

損失関数群:

F2 形式の混合出力損失 loss_real_with_attn_F2（stat/sem の加重和）。

反事実・単調性制約、I トークンの分散促進 (cosine_divergence_I)、アテンションエントロピー正則化、環境トークンへの注意促進などが用意されています。

ε 距離計算用の補助関数群 (dC, dM, epsilon_between_models) と、εをゲート係数αへ写像するヘルパーもあります。

学習ループ:

2000エポックを回し、αに基づいて各損失の重みを動的にスケーリング。F2 混合損失・semantic 専用損失・因果/単調性/I 構造正則化・自己注意抑制（self_target）などを合成。

200エポックごとに前回モデルとの差異からεとαを更新し、適応的にブランチ比率を調整。

評価と可視化: 反事実チェック（sun=0 / plant=0）と、growth クエリの平均アテンション分布を表示・棒グラフ化。
